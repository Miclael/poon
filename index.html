<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>QuaggaJS Live Demo</title>
  <script src="https://unpkg.com/@ericblade/quagga2@2.0.0-beta.5/dist/quagga.js"></script>
</head>
<body>
  <div id="interactive" style="width:90vw;max-width:400px;height:320px;margin:10px auto;"></div>
  <button onclick="startScan()">開啟相機</button>
  <button onclick="stopScan()">關閉相機</button>
  <pre id="result"></pre>
  <script>
    let scanning = false;
    function startScan() {
      if (scanning) return;
      Quagga.init({
        inputStream: {
          name: "Live",
          type: "LiveStream",
          target: document.querySelector('#interactive'),
          constraints: {
            facingMode: "environment"
          }
        },
        decoder: {
          readers: ["code_128_reader", "ean_reader", "ean_8_reader", "code_39_reader"]
        },
        locate: true
      }, function (err) {
        if (err) { alert(err); return }
        Quagga.start();
        scanning = true;
      });
      Quagga.onDetected(function (result) {
        document.getElementById('result').innerText = result.codeResult.code;
      });
    }
    function stopScan() {
      if (scanning) {
        Quagga.stop();
        scanning = false;
      }
    }
  </script>
</body>
</html>
